#define F_CPU 1000000
#include <avr/io.h>
#include <util/delay.h>

unsigned int instructions[256]={
	0x7023,0x7035,0x4231,0x4134,0x7452,0x9323,0x0222,0x8441,0x2421,0xc250,0xe441,0xa422,0x6241,0xf153,0xc220,0x9610,
	0x8661,0x9630,0x8661,0x3115,0x7661,0xa610,0xb336,0x964f,0xa342,0x9640,0x8661,0xa640,0x7661,0xa630,0x5333,0x7661,
	0xa630,0xc250,0x1311,0x8113,0xc0f0,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
	0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
	0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
	0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
	0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
	0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
	0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
	0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
	0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
	0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
	0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
	0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
	0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000};


int main(void)
{
	DDRA=0XFF; //output
	DDRB=0x00; //input
	DDRC=0xFF; //output
	DDRD = 0xFF; //output
	
	MCUCSR|=(1<<JTD);
	MCUCSR|=(1<<JTD);
	
	unsigned int cur_instruction;
	unsigned int dst;
	unsigned int src_reg_2;
	unsigned int src_reg_1;
	unsigned int opcode;
	
	int pc = 0;
	PORTA = 0;
	PORTC = 0;
	
	/* Replace with your application code */
	while (1) {
		pc = PINB;
		cur_instruction = instructions[pc];
		dst = 0x000F & cur_instruction;
		src_reg_2 = 0x00F0 & cur_instruction;
		src_reg_1 = (0x0F00 & cur_instruction);
		opcode = (0xF000 & cur_instruction);
		PORTA = src_reg_2 | dst; //src2|dst
		PORTC = (src_reg_1 >> 8) | (opcode >> 8); // opcode|src1
		PORTD = (src_reg_1 >> 4) | (src_reg_2 >> 4); // src1 | src2
		// target address is PORTA full 8 bit
		_delay_ms(10);
	}
}
//InstructionMemory